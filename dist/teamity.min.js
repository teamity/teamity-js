/*! For license information please see teamity.min.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Teamity=e():t.Teamity=e()}(this,(function(){return(()=>{var t={668:(t,e,n)=>{function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=n(953),s=u.kTeamityRaw,f=u.kTeamityUrl,h=n(522).default,y=window.WebSocket,p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(p,t);var e,n,r,u,h=(r=p,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=l(r);if(u){var n=l(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return c(this,t)});function p(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),(e=h.call(this))[f]=t,e}return e=p,(n=[{key:"$url",get:function(){return this[f]}},{key:"$raw",get:function(){return this[s]}},{key:"$connected",get:function(){return this.$raw&&this.$raw.readyState===y.OPEN}},{key:"$disconnected",get:function(){return this.$raw&&this.$raw.readyState===y.CLOSED}},{key:"open",value:function(){this.$connected||(this[s]=new y(this.$url),this.$raw.onopen=i(l(p.prototype),"emit",this).bind(this,"connect"),this.$raw.onerror=i(l(p.prototype),"emit",this).bind(this,"error"),this.$raw.onclose=i(l(p.prototype),"emit",this).bind(this,"disconnect"),this.$raw.onmessage=b.bind(this))}},{key:"emit",value:function(t,e){var n=new TextEncoder;t instanceof Uint8Array||("string"!=typeof t&&(t=t.toString()),t=n.encode(t)),e instanceof Uint8Array||("string"!=typeof e&&(e=JSON.stringify(e)),e=n.encode(e));var r=n.encode("\n"),o=t.byteLength+r.byteLength+e.byteLength,i=new Uint8Array(o),a=0;i.set(t,a),a+=t.byteLength,i.set(r,a),a+=r.byteLength,i.set(e,a),this.$raw.send(i)}},{key:"close",value:function(){this.$raw.close()}},{key:"request",value:function(t,e){var n=this;return new Promise((function(r,o){n.once(t,(function(t){r(t)})),n.emit(t,e)}))}},{key:"superEmit",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];(t=i(l(p.prototype),"emit",this)).call.apply(t,[this].concat(n))}}])&&o(e.prototype,n),p}(h);function b(t){var e=this;try{var n=t.data,r=new TextDecoder;(function(t){return new Promise((function(e,n){t.arrayBuffer?t.arrayBuffer().then((function(t){e(new Uint8Array(t))})):n(new Error("data format error"))}))})(n).then((function(t){var n=t.findIndex((function(t){return"\n"===String.fromCharCode(t)}));if(!(n<0)){var o=t.slice(0,n),i=t.slice(n+"\n".length);e.superEmit(r.decode(o),JSON.parse(r.decode(i)))}}))}catch(t){}}t.exports=function(t){return new p(t)}},522:(t,e,n)=>{"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.r(e),n.d(e,{default:()=>l});var i=Function.prototype.apply,a=new WeakMap;function c(t){return a.has(t)||a.set(t,{}),a.get(t)}var l=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:console;r(this,t);var o=c(this);return o._events=new Set,o._callbacks={},o._console=n,o._maxListeners=null===e?null:parseInt(e,10),this}var e,n;return e=t,(n=[{key:"_addCallback",value:function(t,e,n,r){return this._getCallbacks(t).push({callback:e,context:n,weight:r}),this._getCallbacks(t).sort((function(t,e){return t.weight>e.weight})),this}},{key:"_getCallbacks",value:function(t){return c(this)._callbacks[t]}},{key:"_getCallbackIndex",value:function(t,e){return this._has(t)?this._getCallbacks(t).findIndex((function(t){return t.callback===e})):null}},{key:"_achieveMaxListener",value:function(t){return null!==c(this)._maxListeners&&c(this)._maxListeners<=this.listenersNumber(t)}},{key:"_callbackIsExists",value:function(t,e,n){var r=this._getCallbackIndex(t,e),o=-1!==r?this._getCallbacks(t)[r]:void 0;return-1!==r&&o&&o.context===n}},{key:"_has",value:function(t){return c(this)._events.has(t)}},{key:"on",value:function(t,e){var n=c(this);if("function"!=typeof e)throw new TypeError("".concat(e," is not a function"));return this._has(t)?(this._achieveMaxListener(t)&&n._console.warn("Max listeners (".concat(n._maxListeners,")")+' for event "'.concat(t,'" is reached!')),this._callbackIsExists.apply(this,arguments)&&n._console.warn('Event "'.concat(t,'"')+" already has the callback ".concat(e,"."))):(n._events.add(t),n._callbacks[t]=[]),this._addCallback.apply(this,arguments),this}},{key:"once",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=function o(){n.off(t,o);for(var a=arguments.length,c=new Array(a),l=0;l<a;l++)c[l]=arguments[l];return i.call(e,r,c)};return this.on(t,a,r,o)}},{key:"off",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=c(this);return this._has(t)&&(null===n?(r._events.delete(t),r._callbacks[t]=null):-1!==(e=this._getCallbackIndex(t,n))&&(r._callbacks[t].splice(e,1),this.off.apply(this,arguments))),this}},{key:"emit",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return this._has(t)&&this._getCallbacks(t).forEach((function(t){return i.call(t.callback,t.context,n)})),this}},{key:"clear",value:function(){var t=c(this);return t._events.clear(),t._callbacks={},this}},{key:"listenersNumber",value:function(t){return this._has(t)?this._getCallbacks(t).length:null}}])&&o(e.prototype,n),t}()},953:t=>{t.exports={kTeamityRaw:Symbol("teamity.raw"),kTeamityUrl:Symbol("teamity.url")}}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}return n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n(668)})()}));
//# sourceMappingURL=teamity.min.js.map